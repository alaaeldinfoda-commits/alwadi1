{% extends 'base.html' %}
{% block content %}

<div class="fade-in-up">

  <!-- HEADER -->
  <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
    <h3 class="fw-bold">
      {% if user %} âœ ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… {% else %} â• Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… {% endif %}
    </h3>

    <a href="/users" class="btn btn-outline-secondary shadow-sm hover-up px-4">
      â¬… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    </a>
  </div>

  <!-- FORM CARD -->
  <div class="card shadow-sm border-0 p-4">

    <form method="POST" class="row g-3">

      <!-- Username -->
      <div class="col-md-6">
        <label class="form-label fw-bold">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
        <input type="text"
               class="form-control form-control-lg input-animate"
               name="username"
               value="{{ user.username if user }}"
               required>
      </div>

      <!-- Full Name -->
      <div class="col-md-6">
        <label class="form-label fw-bold">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
        <input type="text"
               class="form-control form-control-lg input-animate"
               name="fullname"
               value="{{ user.fullname if user }}">
      </div>

      <!-- Password -->
      <div class="col-md-6">
        <label class="form-label fw-bold">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>

        <div class="input-group">
          <input type="password"
                 id="passwordField"
                 class="form-control form-control-lg input-animate"
                 name="password"
                 placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                 {% if not user %} required {% endif %}>

          <button type="button"
                  class="btn btn-outline-secondary"
                  onclick="togglePassword()">
            ğŸ‘
          </button>
        </div>

        <!-- Password Strength -->
        <div class="mt-2">
          <small id="passStrength" class="fw-bold"></small>
        </div>
      </div>

      <!-- ROLE -->
      <div class="col-md-6">
        <label class="form-label fw-bold">Ø§Ù„Ø¯ÙˆØ±</label>
        <select name="role_id"
                class="form-select form-select-lg input-animate">
          {% for r in roles %}
            <option value="{{ r.role_id }}"
              {% if user and user.role_id == r.role_id %} selected {% endif %}>
              {{ r.role_name }}
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- SUBMIT -->
      <div class="col-12 text-end mt-3">
        <button class="btn btn-primary btn-lg hover-scale px-5">
          ğŸ’¾ Ø­ÙØ¸
        </button>
      </div>

    </form>

  </div>

</div>

<!-- =====================  STYLES  ===================== -->
<style>
.fade-in-up { animation: fadeInUp .6s ease; }
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

.input-animate {
  transition: 0.25s ease;
}
.input-animate:focus {
  transform: scale(1.03);
  border-color: var(--bs-primary);
  box-shadow: 0 0 8px rgba(13,110,253,0.3);
}

.hover-scale { transition: .25s ease; }
.hover-scale:hover { transform: scale(1.05); }

.hover-up { transition: .25s ease; }
.hover-up:hover { transform: translateY(-4px); }

/* Password colors */
.strength-weak { color: red; }
.strength-mid  { color: orange; }
.strength-strong { color: green; }
</style>


<!-- =====================  SCRIPT  ===================== -->
<script>
/* Show / Hide Password */
function togglePassword() {
  const field = document.getElementById('passwordField');
  field.type = field.type === "password" ? "text" : "password";
}

/* Password Strength Indicator */
document.getElementById("passwordField").addEventListener("input", function () {
  let pass = this.value;
  let strength = document.getElementById("passStrength");

  if (pass.length < 4) {
    strength.innerText = "Ø¶Ø¹ÙŠÙØ© Ø¬Ø¯Ù‹Ø§";
    strength.className = "strength-weak";
  } 
  else if (pass.length < 7) {
    strength.innerText = "Ù…ØªÙˆØ³Ø·Ø©";
    strength.className = "strength-mid";
  } 
  else {
    strength.innerText = "Ù‚ÙˆÙŠØ©";
    strength.className = "strength-strong";
  }
});
</script>

{% endblock %}
