{% extends 'base.html' %}
{% block content %}

<div class="fade-in-up">

  <!-- HEADER + ACTIONS -->
  <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
    <h3 class="fw-bold">ğŸ›  Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„ÙˆÙ†</h3>

    <a href="/contractors/add" class="btn btn-primary shadow px-4 hover-scale">
      â• Ø¥Ø¶Ø§ÙØ© Ù…Ù‚Ø§ÙˆÙ„ Ø¬Ø¯ÙŠØ¯
    </a>
  </div>

  <!-- SEARCH BAR -->
  <div class="card shadow-sm border-0 mb-4 p-3">
    <div class="row g-2">
      <div class="col-md-5">
        <input type="text" id="searchBox" class="form-control"
               placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙâ€¦"
               onkeyup="filterContractors()">
      </div>
    </div>
  </div>

  <!-- CONTRACTORS TABLE -->
  <div class="card border-0 shadow-sm">
    <div class="card-body">

      <table class="table table-hover align-middle" id="contractorsTable">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Ø§Ù„Ø§Ø³Ù…</th>
            <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
            <th class="text-end">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
          </tr>
        </thead>

        <tbody>
        {% for c in contractors %}
          <tr class="contractor-row">
            <td>{{ c.contractor_id }}</td>

            <td class="fw-bold">
              ğŸ§± {{ c.contractor_name }}
            </td>

            <td>
              <span class="badge bg-info">
                ğŸ“ {{ c.phone or 'â€”' }}
              </span>
            </td>

            <td class="text-end">

              <a href="/contractors/edit/{{ c.contractor_id }}"
                 class="btn btn-sm btn-outline-secondary hover-up">
                âœ ØªØ¹Ø¯ÙŠÙ„
              </a>

              <a href="/contractors/delete/{{ c.contractor_id }}"
                 class="btn btn-sm btn-outline-danger hover-up"
                 onclick="return confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„ØŸ')">
                ğŸ—‘ Ø­Ø°Ù
              </a>

            </td>
          </tr>
        {% endfor %}
        </tbody>

      </table>

    </div>
  </div>

</div>


<!-- STYLES -->
<style>
/* Fade Animation */
.fade-in-up { animation: fadeInUp .5s ease; }
@keyframes fadeInUp {
  from { opacity:0; transform: translateY(15px); }
  to   { opacity:1; transform: translateY(0); }
}

/* Card Hover Effects */
.hover-scale {
  transition: 0.25s ease;
}
.hover-scale:hover {
  transform: scale(1.05);
}

.hover-up {
  transition: 0.3s ease;
}
.hover-up:hover {
  transform: translateY(-3px);
}

/* Table Hover */
.table-hover tbody tr:hover {
  background: rgba(0,123,255,0.06);
}

/* Responsive */
@media (max-width: 768px) {
  table { font-size: 14px; }
}
</style>


<!-- FILTER SCRIPT -->
<script>
function filterContractors() {
  let search = document.getElementById("searchBox").value.toLowerCase();

  document.querySelectorAll(".contractor-row").forEach(row => {
    let name  = row.children[1].innerText.toLowerCase();
    let phone = row.children[2].innerText.toLowerCase();

    if (name.includes(search) || phone.includes(search)) {
      row.style.display = "";
    } else {
      row.style.display = "none";
    }
  });
}
</script>

{% endblock %}
